<!DOCTYPE html>

<meta charset="utf-8" />

<title>Win32Forth</title>

<script language="javascript" type="text/javascript">
var lastlen=0;
var fHeader='';
var startstop=0;
var sendint=false;
var r1st=0;

function doit(cntnu)
{
  var dsp=document.getElementById('dsp');
  if(sendint){
     sendint=false;
     cntnu=4;
  }
  if(fHeader==5){
     fHeader=0;
     return;
  }
  if(startstop==3){
     cntnu=3;
  }
  var ntxt=cntnu.toString();
  if(!cntnu){
    var txt=dsp.value;
    ntxt=txt.substring(lastlen-1);
    if(!fHeader &&  ntxt[ntxt.length-1] == '\n'){
      ntxt=ntxt.slice(0,ntxt.length-1);}
    if(ntxt[0]=='\n') ntxt=ntxt.slice(1);
  }
  fetch('',{method: 'post',body:ntxt,headers: {
      'Content-Type': 'text/plain'
     }
  })
  .then(response =>{
    fHeader = response.headers.get('ForthContinue');
    return response.text();
   })
  .then(function(data) {
     var dtxt=dsp.value;
     if((!fHeader || r1st) && dtxt[dtxt.length-1]=='\n'){
      dtxt=dtxt.slice(0,dtxt.length-1);
     }
     r1st=0;
     if(fHeader==5) fHeader=0;
     dtxt+=data;
     lastlen=dtxt.length;
     dsp.value=dtxt;
     dsp.scrollTop=dsp.scrollHeight;
     if(fHeader==2 && !window.startstop){
        doit(1);
     }
  })
  .catch(error => console.log('error is', error));

}
</script>
<body>
Web32Forth 4.06 by Robert Ackerman & John Peters 415-239-5393<br>
CG is a database of electrical parts. The name Contract Generator is TM<br>
<br>
<textarea id='dsp' rows=30 cols=150 autofocus style="font-family:courier;font-size:18px;font-weight: bold;"></textarea>
<script>
    //var dsp=document.getElementById('dsp');
    document.addEventListener("keydown",function(event) {
    if (event.key === "Enter") {
        r1st=1;
        doit(0);
    }
    else if(event.key === 'Escape' && fHeader){  // quit long response
        sendint=true;
    }
    else if(fHeader){    // start/stop long response
        if(startstop){
          startstop=0;
          event.preventDefault();
          doit(2);       // continue
        }
        else{
          startstop=3;
          event.preventDefault();
        }
    }
});
</script>
<br>
Try  &#58 TEST 8 0 do &#46&#34 Hi World &#34 cr loop &#59<br>
Win32Forth and all it's thousands of words are here for your use<br>
<br>
<br>
If you type the following lines:<br>
CB <br>
CB <br>
TOTAL <br>
<br>
It will list the install times, the parts cost and the "Sell" price for a 20A Circuit Breaker and it wil look like this<br>
<br>
CB                 1@            8.00 =      8.00      0.20 hr     36.00     44.00<br>
total           Count            Part       Parts      Time        Labor      Sell<br>
<br>
C-B   WORDS will list the various sizes of circuit breakers<br>
EMT   WORDS will give the sizes of EMT (Electro Metalic Tubing)<br>
<br>
Other good words are RISER-100A, PVC-PIPE, EMT-90, METER, METER-RT, PANEL<br>
<br>
John Alan Peters japeters747@gmail.com<br>
P.S. If you get a -13 error for no reason, turn off "smart-punctuation" - (General/Keyboards/Smart)<br>
<br>
</body>
</html>

